<h2 class="c-parme bd-bt">Détails des hébergements</h2>

<table class="table table-striped table-hover" id="server_table">
    <thead>
        <tr class="table-dark">
            {% include 'helpers/table-head/client.html.twig' %}
            {% include 'helpers/table-head/prestataire.html.twig' %}
            {% include 'helpers/table-head/offre.html.twig' %}
            {% include 'helpers/table-head/cost.html.twig' %}
            {% include 'helpers/table-head/price.html.twig' %}
            {% include 'helpers/table-head/renew.html.twig' %}
            {% include 'helpers/table-head/start.html.twig' %}
            {% include 'helpers/table-head/date-renew.html.twig' %}
            {% include 'helpers/table-head/actif.html.twig' %}
            <th>Sites</th>
            {% include 'helpers/table-head/domains.html.twig' %}
            {% include 'helpers/table-head/clickcollects.html.twig' %}
            {% include 'helpers/table-head/empty-non-sortable.html.twig' %}
        </tr>
    </thead>
    <tbody>
        {% if servers is  not defined %}
            {% set servers = currentClient.servers %}
        {% endif %}
        {% for currentServer in servers %}
            <tr class="align-middle">
                {% set client = currentServer.client %}
                {% include 'helpers/table-body/client.html.twig' %}
                {% include 'helpers/table-body/provider.html.twig' with {'provider': currentServer.provider} only %}
                {% include 'helpers/table-body/offer.html.twig' with {'offer': currentServer.offer} only %}
                {% include 'helpers/table-body/price-ht.html.twig' with {'price': currentServer.cost} only %}
                {% include 'helpers/table-body/price-ht.html.twig' with {'price': currentServer.invoicedPrice} only %}
                {% include 'helpers/table-body/renewal-type.html.twig' with {'renewalType': currentServer.renewalType } only %}
                {% include 'helpers/table-body/date.html.twig' with {'date': currentServer.startDate} only %}
                {% include 'helpers/table-body/date.html.twig' with {'date': currentServer.renewalDate} only %}
                {% include 'helpers/table-body/oui-non.html.twig' with {'boolean': currentServer.enable} only %}
                <td>
                    {% if not currentServer.sites|length %}Aucun{% endif %}
                    {% for site in currentServer.sites %}
                        <div>
                            - {{ site.name }}
                            <a class="a-link btn" href="{{ path('server_remove_site', {'id' : currentServer.id, 'siteId' : site.id}) }}"
                               onclick="return confirm('Souhaitez-vous vraiment supprimer le site : ' + '{{ site.name }}')">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                            </a>
                        </div>
                    {% endfor %}
                </td>
                {% set domainNames = currentServer.domainNames %}
                {% include 'helpers/table-body/domains.html.twig' %}
                {% include 'helpers/table-body/clickcollects.html.twig' %}
                {% include 'helpers/table-body/edit-link.html.twig' with {'link': path('server_edit', {'id': currentServer.id})} only %}
            </tr>
        {% endfor %}
    </tbody>
</table>
<script>
    {# TODO : check this #}
    function updateAddRenewalDate(url) {
        ajax = $.ajax({
            url: url,
            type: 'GET',
            success: function() {
                location.reload();
            },
        });
    }
</script>
