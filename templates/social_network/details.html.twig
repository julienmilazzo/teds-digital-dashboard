<h2 class="c-parme bd-bt">Détails des réseaux sociaux</h2>

<table class="table table-striped table-hover" id="social_table">
    <thead>
        <tr class="table-dark">

            {% include 'helpers/table-head/client.html.twig' %}
            {% include 'helpers/table-head/prestataire.html.twig' %}
            {% include 'helpers/table-head/offre.html.twig' %}
            {% include 'helpers/table-head/cost.html.twig' %}
            {% include 'helpers/table-head/price.html.twig' %}
            {% include 'helpers/table-head/renew.html.twig' %}
            {% include 'helpers/table-head/start.html.twig' %}
            {% include 'helpers/table-head/date-renew.html.twig' %}
            {% include 'helpers/table-head/actif.html.twig' %}
            {% include 'helpers/table-head/commentary.html.twig' %}
            <th>Post par semaine :</th>
            <th>Quel Réseaux ? </th>
            {% include 'helpers/table-head/empty-non-sortable.html.twig' %}
        </tr>
    </thead>
    <tbody>
        {% for currentSocialNetwork in socialNetworks %}
            <tr class="align-middle">
                {% set client = currentSocialNetwork.client %}
                {% include 'helpers/table-body/client.html.twig' %}
                <td>{{ currentSocialNetwork.provider }}</td>
                <td>{{ currentSocialNetwork.offer }}</td>
                <td>{{ currentSocialNetwork.cost }}</td>
                <td>{{ currentSocialNetwork.invoicedPrice }}</td>
                <td>{{ currentSocialNetwork.renewalType }}</td>
                {% include 'helpers/table-body/date.html.twig' with {'date': currentSocialNetwork.startDate} only %}
                {% include 'helpers/table-body/date.html.twig' with {'date': currentSocialNetwork.renewalDate} only %}
                {% include 'helpers/table-body/oui-non.html.twig' with {'boolean': currentSocialNetwork.enable} only %}
                {% include 'helpers/table-body/commentary.html.twig' with {'commentary': currentSocialNetwork.commentary} only %}
                <td class="text-center">{{ currentSocialNetwork.postByWeek }}</td>
                <td>
                    {% if currentSocialNetwork.whichSocialNetwork|length is not same as 0 %}
                        {% for i in 0..((currentSocialNetwork.whichSocialNetwork|length)-1) %}
                            - {{ currentSocialNetwork.whichSocialNetwork[i] }} <br>
                        {% endfor %}
                    {% else %}
                        Aucun
                    {% endif %}
                </td>
                <td class="text-center">
                    <a href="{{ path('social_network_edit', {'id': currentSocialNetwork.id}) }}" class="btn blue">
                        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    </a>
                    {% if date(currentSocialNetwork.renewalDate) < date('+1month') %}
                        <button onclick="updateAddRenewalDate('{{ path('updateAddRenewalDate', {id: currentSocialNetwork.id}) }}')" class="btn parme">
                            Facturé
                        </button>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
<script>
    {# TODO : check this #}
    function updateAddRenewalDate(url) {
        ajax = $.ajax({
            url: url,
            type: 'GET',
            success: function() {
                location.reload();
            },
        });
    }
</script>
